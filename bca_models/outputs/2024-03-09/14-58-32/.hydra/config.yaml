features_root_dir: null
logs_root_dir: null
task:
  data:
    n_tiles: 4
    feature_extractor: iBOTViTBaseBCa
    train:
      _target_: rl_benchmarks.datasets.SlideClassificationDataset
      cohort: SUQH_ROI_MODEL
  validation_scheme:
    _target_: rl_benchmarks.val_schemes.NestedCrossValidation
    n_repeats_outer: 1
    n_splits_outer: 2
    n_repeats_inner: 1
    n_splits_inner: 2
    stratified: true
    split_mode: patient_split
    grid_search_params:
      learning_rate:
      - 0.001
      - 0.0001
      weight_decay:
      - 0.0
      - 0.0001
    trainer_cfg:
      _target_: rl_benchmarks.trainers.TorchTrainer
      batch_size: 16
      num_epochs: 50
      learning_rate: 0.0002
      weight_decay: 0.0
      device: cuda:0
      optimizer:
        _target_: torch.optim.Adam
        _partial_: true
      train_step:
        _target_: rl_benchmarks.utils.slide_level_train_step
        _partial_: true
      val_step:
        _target_: rl_benchmarks.utils.slide_level_val_step
        _partial_: true
      collator:
        _target_: rl_benchmarks.utils.pad_collate_fn
        _partial_: true
      model:
        _target_: rl_benchmarks.models.MeanPool
      criterion:
        _target_: rl_benchmarks.losses.BCEWithLogitsLoss
      metrics:
        auc:
          _target_: rl_benchmarks.metrics.compute_binary_auc
          _partial_: true
        accuracy:
          _target_: rl_benchmarks.metrics.compute_binary_accuracy
          _partial_: true
model:
  _target_: rl_benchmarks.models.MeanPool
